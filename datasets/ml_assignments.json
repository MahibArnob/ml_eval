[
  {
    "id": "Mall_Cust_Dataset_f976700d_q0",
    "dataset_file": "Mall_Cust_Dataset_f976700d.csv",
    "dataset_path": "/Users/orno3564/Desktop/summer-project/athena/media/mldataset_files/Mall_Cust_Dataset_f976700d.csv",
    "question_text": "You are provided with a dataset containing information about customers in a mall. The dataset includes the following columns: 'CustomerID', 'Genre', 'Age', 'Annual Income (k$)', and 'Spending Score (1-100)'. Your task is to perform customer segmentation using the KMeans clustering algorithm. The goal is to group the customers into distinct clusters based on their annual income and spending score.\n\nRequirements:\n1. Load the dataset using pandas.\n2. Perform data preprocessing if necessary (e.g., handling missing values, encoding categorical variables).\n3. Use the KMeans algorithm from sklearn to cluster the customers.\n4. Determine the optimal number of clusters using the elbow method.\n5. Visualize the clusters using a scatter plot.\n\nHere is a sample of the dataset:\n\n| CustomerID | Genre  | Age | Annual Income (k$) | Spending Score (1-100) |\n|------------|--------|-----|--------------------|------------------------|\n| 1          | Male   | 19  | 15                 | 39                     |\n| 2          | Male   | 21  | 15                 | 81                     |\n| 3          | Female | 20  | 16                 | 6                      |\n\nWrite a Python script to accomplish the above tasks.",
    "reference_code": "import pandas as pd\nimport matplotlib.pyplot as plt\nfrom sklearn.cluster import KMeans\n\n# Load the dataset\ndf = pd.read_csv('Mall_Cust_Dataset_f976700d.csv')\n\n# Select the features for clustering\nX = df[['Annual Income (k$)', 'Spending Score (1-100)']]\n\n# Determine the optimal number of clusters using the elbow method\nwcss = []\nfor i in range(1, 11):\n    kmeans = KMeans(n_clusters=i, init='k-means++', max_iter=300, n_init=10, random_state=42)\n    kmeans.fit(X)\n    wcss.append(kmeans.inertia_)\n\n# Plot the elbow method graph\nplt.plot(range(1, 11), wcss)\nplt.title('Elbow Method')\nplt.xlabel('Number of clusters')\nplt.ylabel('WCSS')\nplt.show()\n\n# From the elbow method, let's assume the optimal number of clusters is 5\nkmeans = KMeans(n_clusters=5, init='k-means++', max_iter=300, n_init=10, random_state=42)\nY_kmeans = kmeans.fit_predict(X)\n\n# Visualize the clusters\nplt.scatter(X.values[Y_kmeans == 0, 0], X.values[Y_kmeans == 0, 1], s=100, c='red', label='Cluster 1')\nplt.scatter(X.values[Y_kmeans == 1, 0], X.values[Y_kmeans == 1, 1], s=100, c='blue', label='Cluster 2')\nplt.scatter(X.values[Y_kmeans == 2, 0], X.values[Y_kmeans == 2, 1], s=100, c='green', label='Cluster 3')\nplt.scatter(X.values[Y_kmeans == 3, 0], X.values[Y_kmeans == 3, 1], s=100, c='cyan', label='Cluster 4')\nplt.scatter(X.values[Y_kmeans == 4, 0], X.values[Y_kmeans == 4, 1], s=100, c='magenta', label='Cluster 5')\nplt.scatter(kmeans.cluster_centers_[:, 0], kmeans.cluster_centers_[:, 1], s=300, c='yellow', label='Centroids')\nplt.title('Clusters of customers')\nplt.xlabel('Annual Income (k$)')\nplt.ylabel('Spending Score (1-100)')\nplt.legend()\nplt.show()",
    "reference_mql": "CONSTRUCT Customer_Clustering AS UNSUPERVISED\nFOR CLUSTER OF 5\nUSING KMeans\nTRAIN ON COUNT(*) TEST ON 0\nFEATURES CustomerID, Genre, Age, Annual_Income_k_, Spending_Score_1_100_\nFROM Mall_Cust_Dataset_f976700d;\n\nGENERATE CLUSTER OF 5 USING MODEL Customer_Clustering FEATURES CustomerID, Genre, Age, Annual_Income_k_, Spending_Score_1_100_\nFROM Mall_Cust_Dataset_f976700d;",
    "dataset_context": "Columns: ['CustomerID', 'Genre', 'Age', 'Annual Income (k$)', 'Spending Score (1-100)']\nSample Data:\n   CustomerID   Genre  Age  Annual Income (k$)  Spending Score (1-100)\n0           1    Male   19                  15                      39\n1           2    Male   21                  15                      81\n2           3  Female   20                  16                       6"
  },
  {
    "id": "Mall_Cust_Dataset_f976700d_q1",
    "dataset_file": "Mall_Cust_Dataset_f976700d.csv",
    "dataset_path": "/Users/orno3564/Desktop/summer-project/athena/media/mldataset_files/Mall_Cust_Dataset_f976700d.csv",
    "question_text": "You are provided with a dataset containing information about customers in a mall. The dataset includes the following columns: ['CustomerID', 'Genre', 'Age', 'Annual Income (k$)', 'Spending Score (1-100)']. Your task is to perform a clustering analysis to segment the customers into distinct groups based on their annual income and spending score. This will help the mall management to understand the different customer segments and tailor their marketing strategies accordingly.\n\nRequirements:\n1. Perform a clustering analysis using the KMeans algorithm.\n2. Use 'Annual Income (k$)' and 'Spending Score (1-100)' as the features for clustering.\n3. Determine the optimal number of clusters using the Elbow method.\n4. Visualize the clusters using a scatter plot.\n\nProvide the Python code solution using pandas and sklearn.",
    "reference_code": "import pandas as pd\nimport matplotlib.pyplot as plt\nfrom sklearn.cluster import KMeans\n\n# Load the dataset\ndf = pd.read_csv('Mall_Cust_Dataset_f976700d.csv')\n\n# Select the features for clustering\nX = df[['Annual Income (k$)', 'Spending Score (1-100)']]\n\n# Determine the optimal number of clusters using the Elbow method\nwcss = []\nfor i in range(1, 11):\n    kmeans = KMeans(n_clusters=i, init='k-means++', max_iter=300, n_init=10, random_state=42)\n    kmeans.fit(X)\n    wcss.append(kmeans.inertia_)\n\n# Plot the Elbow method graph\nplt.figure(figsize=(10, 5))\nplt.plot(range(1, 11), wcss, marker='o')\nplt.title('Elbow Method')\nplt.xlabel('Number of clusters')\nplt.ylabel('WCSS')\nplt.show()\n\n# From the Elbow method graph, choose the optimal number of clusters (e.g., 5)\noptimal_clusters = 5\n\n# Apply KMeans with the optimal number of clusters\nkmeans = KMeans(n_clusters=optimal_clusters, init='k-means++', max_iter=300, n_init=10, random_state=42)\nclusters = kmeans.fit_predict(X)\n\n# Add the cluster labels to the original dataframe\ndf['Cluster'] = clusters\n\n# Visualize the clusters\nplt.figure(figsize=(10, 5))\nplt.scatter(X.iloc[:, 0], X.iloc[:, 1], c=clusters, cmap='viridis')\nplt.title('Customer Segments')\nplt.xlabel('Annual Income (k$)')\nplt.ylabel('Spending Score (1-100)')\nplt.show()",
    "reference_mql": "CONSTRUCT Customer_Segments AS UNSUPERVISED\nFOR CLUSTER OF 5\nUSING KMeans\nTRAIN ON COUNT(*) TEST ON 0\nFEATURES CustomerID, Genre, Age, Annual_Income_k_, Spending_Score_1_100_\nFROM Mall_Cust_Dataset_f976700d;\n\nGENERATE CLUSTER OF 5 USING MODEL Customer_Segments FEATURES CustomerID, Genre, Age, Annual_Income_k_, Spending_Score_1_100_\nFROM Mall_Cust_Dataset_f976700d;",
    "dataset_context": "Columns: ['CustomerID', 'Genre', 'Age', 'Annual Income (k$)', 'Spending Score (1-100)']\nSample Data:\n   CustomerID   Genre  Age  Annual Income (k$)  Spending Score (1-100)\n0           1    Male   19                  15                      39\n1           2    Male   21                  15                      81\n2           3  Female   20                  16                       6"
  }
]