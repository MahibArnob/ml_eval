{"assignment_id": "Mall_Cust_Dataset_f976700d_q0", "student_code": "import pandas as pd\nimport matplotlib.pyplot as plt\nfrom sklearn.cluster import KMeans\n\n# Load the dataset\ndf = pd.read_csv('Mall_Cust_Dataset_f976700d.csv')\n\n# Select the features for clustering\nX = df[['Annual Income (k$)', 'Spending Score (1-100)']]\n\n# Determine the optimal number of clusters using the elbow method\nwcss = []\nfor i in range(1, 11):\n    kmeans = KMeans(n_clusters=i, init='k-means++', max_iter=300, n_init=10, random_state=42)\n    kmeans.fit(X)\n    wcss.append(kmeans.inertia_)\n\n# Plot the elbow method graph\nplt.plot(range(1, 11), wcss)\nplt.title('Elbow Method')\nplt.xlabel('Number of clusters')\nplt.ylabel('WCSS')\nplt.show()\n\n# From the elbow method, let's assume the optimal number of clusters is 5\nkmeans = KMeans(n_clusters=5, init='k-means++', max_iter=300, n_init=10, random_state=42)\nY_kmeans = kmeans.fit_predict(X)\n\n# Visualize the clusters\nplt.scatter(X.values[Y_kmeans == 0, 0], X.values[Y_kmeans == 0, 1], s=100, c='red', label='Cluster 1')\nplt.scatter(X.values[Y_kmeans == 1, 0], X.values[Y_kmeans == 1, 1], s=100, c='blue', label='Cluster 2')\nplt.scatter(X.values[Y_kmeans == 2, 0], X.values[Y_kmeans == 2, 1], s=100, c='green', label='Cluster 3')\nplt.scatter(X.values[Y_kmeans == 3, 0], X.values[Y_kmeans == 3, 1], s=100, c='cyan', label='Cluster 4')\nplt.scatter(X.values[Y_kmeans == 4, 0], X.values[Y_kmeans == 4, 1], s=100, c='magenta', label='Cluster 5')\nplt.scatter(kmeans.cluster_centers_[:, 0], kmeans.cluster_centers_[:, 1], s=300, c='yellow', label='Centroids')\nplt.title('Clusters of customers')\nplt.xlabel('Annual Income (k$)')\nplt.ylabel('Spending Score (1-100)')\nplt.legend()\nplt.show()", "student_mql": "CONSTRUCT Customer_Clustering AS UNSUPERVISED\nFOR CLUSTER OF 5\nUSING KMeans\nTRAIN ON COUNT(*) TEST ON 0\nFEATURES CustomerID, Genre, Age, Annual_Income_k_, Spending_Score_1_100_\nFROM Mall_Cust_Dataset_f976700d;\n\nGENERATE CLUSTER OF 5 USING MODEL Customer_Clustering FEATURES CustomerID, Genre, Age, Annual_Income_k_, Spending_Score_1_100_\nFROM Mall_Cust_Dataset_f976700d;", "instructor_mql": "CONSTRUCT Customer_Clustering AS UNSUPERVISED\nFOR CLUSTER OF 5\nUSING KMeans\nTRAIN ON COUNT(*) TEST ON 0\nFEATURES CustomerID, Genre, Age, Annual_Income_k_, Spending_Score_1_100_\nFROM Mall_Cust_Dataset_f976700d;\n\nGENERATE CLUSTER OF 5 USING MODEL Customer_Clustering FEATURES CustomerID, Genre, Age, Annual_Income_k_, Spending_Score_1_100_\nFROM Mall_Cust_Dataset_f976700d;", "score": 10.0, "feedback": "Excellent work! Your clustering implementation using KMeans is correct and matches the requirements perfectly. You selected the appropriate features ('Annual Income (k$)' and 'Spending Score (1-100)') for clustering, determined the optimal number of clusters using the elbow method, and visualized the clusters accurately. Keep up the great work!", "semantic_match": true, "issues": []}
{"assignment_id": "Mall_Cust_Dataset_f976700d_q1", "student_code": "import pandas as pd\nimport matplotlib.pyplot as plt\nfrom sklearn.cluster import KMeans\n\n# Load the dataset\ndf = pd.read_csv('Mall_Cust_Dataset_f976700d.csv')\n\n# Select the features for clustering\nX = df[['Annual Income (k$)', 'Spending Score (1-100)']]\n\n# Determine the optimal number of clusters using the Elbow method\nwcss = []\nfor i in range(1, 11):\n    kmeans = KMeans(n_clusters=i, init='k-means++', max_iter=300, n_init=10, random_state=42)\n    kmeans.fit(X)\n    wcss.append(kmeans.inertia_)\n\n# Plot the Elbow method graph\nplt.figure(figsize=(10, 5))\nplt.plot(range(1, 11), wcss, marker='o')\nplt.title('Elbow Method')\nplt.xlabel('Number of clusters')\nplt.ylabel('WCSS')\nplt.show()\n\n# From the Elbow method graph, choose the optimal number of clusters (e.g., 5)\noptimal_clusters = 5\n\n# Apply KMeans with the optimal number of clusters\nkmeans = KMeans(n_clusters=optimal_clusters, init='k-means++', max_iter=300, n_init=10, random_state=42)\nclusters = kmeans.fit_predict(X)\n\n# Add the cluster labels to the original dataframe\ndf['Cluster'] = clusters\n\n# Visualize the clusters\nplt.figure(figsize=(10, 5))\nplt.scatter(X.iloc[:, 0], X.iloc[:, 1], c=clusters, cmap='viridis')\nplt.title('Customer Segments')\nplt.xlabel('Annual Income (k$)')\nplt.ylabel('Spending Score (1-100)')\nplt.show()", "student_mql": "CONSTRUCT Customer_Segments AS UNSUPERVISED\nFOR CLUSTER OF 5\nUSING KMeans\nTRAIN ON COUNT(*) TEST ON 0\nFEATURES CustomerID, Genre, Age, Annual_Income_k_, Spending_Score_1_100_\nFROM Mall_Cust_Dataset_f976700d;\n\nGENERATE CLUSTER OF 5 USING MODEL Customer_Segments FEATURES CustomerID, Genre, Age, Annual_Income_k_, Spending_Score_1_100_\nFROM Mall_Cust_Dataset_f976700d;", "instructor_mql": "CONSTRUCT Customer_Segments AS UNSUPERVISED\nFOR CLUSTER OF 5\nUSING KMeans\nTRAIN ON COUNT(*) TEST ON 0\nFEATURES CustomerID, Genre, Age, Annual_Income_k_, Spending_Score_1_100_\nFROM Mall_Cust_Dataset_f976700d;\n\nGENERATE CLUSTER OF 5 USING MODEL Customer_Segments FEATURES CustomerID, Genre, Age, Annual_Income_k_, Spending_Score_1_100_\nFROM Mall_Cust_Dataset_f976700d;", "score": 10.0, "feedback": "Your Python code correctly performs the clustering analysis as required. You used the KMeans algorithm and selected 'Annual Income (k$)' and 'Spending Score (1-100)' as features for clustering. You also determined the optimal number of clusters using the Elbow method and visualized the clusters using a scatter plot. Excellent work!", "semantic_match": true, "issues": []}
